"use strict";(self.webpackChunk_roots_bud_sage=self.webpackChunk_roots_bud_sage||[]).push([[1562,6580,1561],{"./scripts/components/chips.js":(t,e,s)=>{s.r(e),s.d(e,{default:()=>i});class i{constructor(t){this.activeItem=null,this.params=t,this.init()}clickHandler(t){const e=t.dataset.term_id;t.addEventListener("click",()=>{this.activeItem.classList.remove("chips-item_active"),t.classList.add("chips-item_active"),this.activeItem=t,this.params?.onChange({categoryId:e})})}init(){const t=document.querySelector(".chips"),e=t?.querySelectorAll(".chips-item");this.activeItem=t?.querySelector(".chips-item_active"),e?.forEach(this.clickHandler.bind(this))}}},"./scripts/components/load-more-articles.js":(t,e,s)=>{s.r(e),s.d(e,{default:()=>i});class i{constructor({el:t,endpoint:e,maxRequest:s,categoryKey:i,searchKey:n}){this.requestWasSent=!1,this.el=t.querySelector(".load-more-articles"),this.noRequestOnInit=this.el?.classList?.contains("no-request-on-init"),this.contentSection=t.querySelector(".load-more-container"),this.track=this.el?.querySelector(".load-more-articles__track"),this.button=this.el?.querySelector(".load-more-articles__button"),this.buttonInitialized=!1,this.page=1,this.endpoint=e,this.initMaxRequest=s?Number(s)||0:2,this.maxAutoRequest=this.initMaxRequest,this.getContent=this.getContent.bind(this),this.categoryKey=i,this.searchKey=n,this.controller=new AbortController,this.init()}reset(){this.controller?.abort(),this.noRequestOnInit=!1,this.pagination=null,this.page=0,this.maxAutoRequest=this.initMaxRequest,this.contentSection.innerHTML="",this.buttonInitialized=!1,this.requestWasSent=!1,this.el?.classList.remove("load-more-articles_show-button"),this.button?.removeEventListener("click",this.getContent)}async getContent(t){if(t?.preventDefault(),this.pagination&&this.pagination.max_num_pages===this.page)return;if(this.requestWasSent)return;this.el?.classList.add("requesting"),this.requestWasSent=!0,this.page+=1;const e=new URL(`${this.endpoint}`);e.searchParams.set("page",this.page),e.searchParams.set("nonce",window.api.nonce);const s=new URLSearchParams(window.location.search),i=s.get(this.categoryKey);i&&e.searchParams.append(this.categoryKey,i);const n=s.get(this.searchKey);n&&e.searchParams.append(this.searchKey,n);let a="";try{this.controller=new AbortController;const t=await fetch(e.toString(),{signal:this.controller.signal}),{data:s,pagination:i}=await t.json();if(a=s,this.el?.classList.remove("requesting"),!i)throw new Error;this.pagination=i,this.page=this.pagination.current_page,this.pagination.max_num_pages===this.page?(this.el?.classList.remove("load-more-articles_show-button"),this.button?.removeEventListener("click",this.getContent)):this.page>=this.maxAutoRequest&&this.initLoadButton()}catch(t){this.pagination={max_num_pages:this.page},this.el?.classList.remove("load-more-articles_show-button")}finally{Array.isArray(a)?this.contentSection.insertAdjacentHTML("beforeend",a.reduce((t,e)=>t+e,"")):a&&this.contentSection.insertAdjacentHTML("beforeend",a),this.el?.classList.remove("requesting"),this.requestWasSent=!1}}initLoadButton(){this.el?.classList.add("load-more-articles_show-button"),this.button&&!this.buttonInitialized&&(this.buttonInitialized=!0,this.button.addEventListener("click",this.getContent))}init(){if(!this.contentSection||!this.track)return;0===this.maxAutoRequest&&this.initLoadButton();new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&(this.noRequestOnInit||this.page<=this.maxAutoRequest&&this.getContent())})},{threshold:0}).observe(this.track)}}},"./scripts/components/offered-articles.js":(t,e,s)=>{s.r(e),s.d(e,{default:()=>a});var i=s("./scripts/components/load-more-articles.js"),n=s("./scripts/components/chips.js");class a extends i.default{constructor(t){super({el:t,endpoint:window.api.route.get.resources.posts,maxRequest:t.dataset.auto_scroll,categoryKey:"category"}),this.updateContent.bind(this),this.load()}updateContent(){this.reset(),this.getContent()}debouncedUpdate(){clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.updateContent()},500)}load(){const t=new URL(window.location.href);new n.default({onChange:({categoryId:e})=>{"0"===e?t.searchParams.delete(this.categoryKey):t.searchParams.set(this.categoryKey,e),history.replaceState(null,"",t.toString()),this.debouncedUpdate()}})}}}}]);